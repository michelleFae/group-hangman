:root{
  --bg: #0f0f12; /* Deep noir background */
  --accent: #6b4f3b; /* Sepia / detective coat */
  --accent-2: #5a6b7c; /* Smoky blue-gray */
  --highlight: #c9a66b; /* Aged paper amber */
  --text: #e6e1dc; /* Parchment-like text */
  --darktext: #040f1a; /* Parchment-like text */
  --muted: #9c948a; /* muted paper ink */
  --halo: rgba(201,166,107,0.12); /* soft amber halo */
}

/* Full-page money theme when winner-by-wordmoney is selected */
body.money-theme-body {
  background: linear-gradient(180deg, #052708, #022204);
}

*{box-sizing:border-box}
body {
  font-family: 'Baloo 2', 'Poppins', system-ui, sans-serif;
  background: linear-gradient(180deg, var(--bg), #121214 80%);
  color: var(--text);
  padding: 28px;
  height: 100vh;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}

/* Subtle floating background blobs (now toned down for noir mood) */
.body-decor {
  position: fixed; inset: 0; pointer-events: none; z-index: 0;
}
.blob {
  position: absolute; filter: blur(36px); opacity: .22; transform: translateZ(0);
}
.blob.l { width: 420px; height: 420px; background: rgba(107,79,59,0.18); left: -100px; top: -80px; border-radius: 50%; animation: floaty 8s ease-in-out infinite; }
.blob.r { width: 360px; height: 360px; background: rgba(90,107,124,0.14); right: -100px; bottom: -60px; border-radius: 50%; animation: floaty 10s ease-in-out infinite; }

@keyframes floaty {
  0% { transform: translateY(0) translateX(0) }
  50% { transform: translateY(12px) translateX(4px) }
  100% { transform: translateY(0) translateX(0) }
}

/* Cards and layout - darker, smoky paper-like cards */
.lobby, .game-room { max-width: 980px; margin: 0 auto; position: relative; z-index: 1 }
.card { background: linear-gradient(180deg, rgba(30,28,32,0.96), rgba(18,16,20,0.92)); border: none; padding: 18px; margin: 16px 0; border-radius: 16px; box-shadow: 0 6px 18px rgba(0,0,0,0.6); transition: transform .22s cubic-bezier(.2,.9,.2,1), box-shadow .2s }
.card:hover { transform: translateY(-6px); box-shadow: 0 14px 28px rgba(0,0,0,0.7) }

/* Dimmed card state (used to indicate disabled/competing action) */
.card-dimmed { opacity: 0.5; pointer-events: none; filter: grayscale(40%); }

h1, h2, h3 { font-family: 'Baloo 2', 'Poppins', sans-serif; color: var(--text); margin: 0 0 12px 0 }
h1 { font-size: 36px }

input, button { font-family: inherit }
input { padding: 10px 12px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.06); background: rgba(20,18,20,0.7); color: var(--text); outline: none; transition: box-shadow .12s, transform .12s }
input:focus { box-shadow: 0 6px 18px rgba(100,90,80,0.06); transform: translateY(-2px) }

button { padding: 10px 12px; background: linear-gradient(90deg,var(--accent),var(--accent-2)); color: white; border: none; border-radius: 12px; cursor: pointer; font-weight: 600; box-shadow: 0 6px 14px rgba(0,0,0,0.6); transition: transform .18s cubic-bezier(.2,.9,.2,1), box-shadow .18s }
button:hover { transform: translateY(-3px) }

/* Landing page primary action glow (Create / Join on the Lobby) */
.lobby .card:first-of-type button,
.lobby .join-btn {
  transition: box-shadow 220ms ease, background 220ms ease, transform 160ms ease;
}
.lobby .card:first-of-type button:focus,
.lobby .card:first-of-type button:hover,
.lobby .join-btn:focus,
.lobby .join-btn:hover {
  box-shadow: 0 8px 30px rgba(255,88,34,0.20), 0 0 28px rgba(255,88,34,0.08) inset;
  background: linear-gradient(135deg, #ff4b1f 0%, #ff9068 60%);
  transform: translateY(-3px) scale(1.01);
  outline: none;
}
.lobby .card:first-of-type button:focus-visible,
.lobby .join-btn:focus-visible {
  box-shadow: 0 0 0 4px rgba(255,88,34,0.14), 0 10px 36px rgba(255,88,34,0.14);
}

/* Disabled button styles: grey, no hover, show not-allowed cursor */
button:disabled,
button[disabled] {
  background: linear-gradient(90deg, #3b3b3b, #343434);
  color: #9b9b9b;
  box-shadow: none;
  cursor: not-allowed;
  transform: none;
}

/* helper class for Locked style in case logic uses class instead of disabled attribute */
.btn-locked {
  background: linear-gradient(90deg, #2e2e2e, #262626);
  color: #9b9b9b;
  cursor: not-allowed;
  pointer-events: none; /* prevent clicks */
  box-shadow: none;
}

/* Player circles */
.circle { display:flex; gap: 16px; flex-wrap:wrap; justify-content:center; padding-top: 2vh; }
.player { width: 200px; border-radius: 16px; text-align: left; padding: 12px; background: linear-gradient(180deg, rgba(22,20,22,0.9), rgba(18,16,20,0.92)); box-shadow: 0 8px 20px rgba(0,0,0,0.6); transition: transform .18s }
 .player:hover { transform: translateY(-6px) }
/* New layout helpers for playing phase: make player tiles slightly more compact and stable */
.player .you-badge { font-size: 11px; font-weight: 800; color: var(--text); background: rgb(184 20 20 / 44%); }
.player .revealed { display: inline-flex; gap: 6px; align-items: center; flex: 1; min-width: 0; max-width: 160px; overflow-x: auto; white-space: nowrap; padding-right: 6px }
.player .revealed span { font-weight: 700; display: inline-block }
.player .revealed::-webkit-scrollbar { height: 6px }
.player .revealed::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.06); border-radius: 3px }

/* Prevent the viewer's own tile from translating vertically (keep stable) */
.player-self { transform: none !important }

.player {
  /* Allow the tile to grow vertically to fit content (buttons, revealed words)
     and prevent clipping of children. Keep position for absolute tooltips. */
  overflow: visible; /* allow children to be fully visible */
  position: relative;
  box-sizing: unset;
}
.player .revealed { pointer-events: auto }
.player button { position: relative; z-index: 60 }
.player .revealed { z-index: 10 }
.player .avatar { z-index: 5 }

/* Actions container for per-player controls: keep inside the card and allow wrapping */
.player .actions {
  display: flex;
  gap: 8px;
  align-items: center;
  flex-wrap: wrap; /* allow buttons to wrap to new line if space is tight */
  min-width: 0; /* allow flex children to shrink */
  /* Ensure actions don't overflow the player tile horizontally; allow vertical growth */
  overflow: visible;
  flex-direction: column;
}

.player .action-button {
  flex: 0 1 auto; /* do not grow, can shrink */
  max-width: 100%;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  box-sizing: border-box;
  /* allow buttons to wrap visually by reducing padding slightly on tight widths */
  min-height: 36px;
}

/* Action type variants: core (Guess), curse, and utility (subdued) */
.player .action-button.core {
  background: linear-gradient(90deg,#3b4650,#2b3238); /* neutral steel gray */
  color: #eef3f6;
  border: 1px solid rgba(255,255,255,0.04);
  box-shadow: 0 6px 18px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
  font-weight: 700;
}
.player .action-button.core:hover { transform: translateY(-2px); box-shadow: 0 12px 28px rgba(0,0,0,0.7), inset 0 1px 0 rgba(255,255,255,0.03) }
.player .action-button.core:disabled { opacity: 0.54; filter: grayscale(30%); cursor: not-allowed }

.player .action-button.curse {
  background: linear-gradient(90deg,#ff7a18,#ff3b00); /* glowing lava accent */
  color: #1b0a00;
  border: 1px solid rgba(255,90,0,0.12);
  box-shadow: 0 8px 28px rgba(255,90,0,0.18), 0 0 18px rgba(255,90,0,0.08) inset;
  font-weight: 800;
}
.player .action-button.curse:hover { transform: translateY(-2px); box-shadow: 0 14px 36px rgba(255,90,0,0.28), 0 0 28px rgba(255,120,40,0.12) }
.player .action-button.curse:disabled { opacity: 0.6; filter: grayscale(30%); cursor: not-allowed }

.player .action-button.utility {
  background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  color: #cfcfcf;
  border: 1px solid rgba(255,255,255,0.03);
  box-shadow: none;
}
.player .action-button.utility:hover { transform: none; box-shadow: 0 6px 12px rgba(0,0,0,0.4) }
.player .action-button.utility:disabled { opacity: 0.6; cursor: not-allowed }

/* For very narrow tiles ensure buttons scale down a bit */
@media (max-width: 420px) {
  .player .action-button { padding: 8px 10px; font-size: 13px }
}

/* tooltip showing the player's submitted word on hover */
.player .revealed { position: relative }
.player .word-tooltip {
  position: absolute;
  left: 0;
  top: 110%;
  background: rgba(10,10,10,0.95);
  color: var(--text);
  padding: 8px 10px;
  border-radius: 8px;
  white-space: nowrap;
  display: none;
  z-index: 120;
  box-shadow: 0 8px 20px rgba(0,0,0,0.8);
  font-weight: 700;
}
.player .revealed:hover .word-tooltip { display: block }
.player .word-tooltip .tip-guessed { color: #ff6b6b; }
.player .word-tooltip .tip-unguessed { color: #fff; opacity: 0.95 }
.avatar { width:56px; height:56px; border-radius:50%; background: linear-gradient(135deg,var(--highlight), #a7885a); display:inline-flex; align-items:center; justify-content:center; font-weight:800; color:var(--text); font-size:20px }
.meta { margin-left: 76px; margin-top: -56px }
.name { font-weight:700 }
.wordmoney { color: var(--accent-2); font-weight:700 }
.revealed { margin-top: 6px; color: var(--highlight); font-size: 13px }

.turn-indicator { text-align:center; margin-bottom: 8px; font-weight:700; color:#ffd000; }

.room-password { margin: 12px 0; padding: 10px; border-radius: 12px; background: linear-gradient(90deg, rgba(107,79,59,0.06), rgba(90,107,124,0.04)); display:inline-block }

.victory-screen { text-align:center; padding: 36px; border-radius: 16px; background: linear-gradient(90deg, var(--accent-2), var(--accent)); color: white }
/* Confetti pieces for victory - keep colorful for celebration */
.victory-screen.confetti { position: relative; overflow: visible }
.confetti-piece { position: absolute; top: -10px; border-radius: 3px; opacity: 0.95; animation: confetti-drop 3.4s cubic-bezier(.2,.7,0,1) forwards; will-change: transform; background: linear-gradient(90deg,#FFD54F,#FFABAB,#81D4FA); }
@keyframes confetti-drop { 0% { transform: translateY(-20px) rotate(0deg); opacity: 0 } 20% { opacity: 1 } 100% { transform: translateY(100vh) rotate(720deg); opacity: 1 } }

/* Sad screen for non-winners */
.victory-screen.sad { background: linear-gradient(90deg, #4b1b1b, #6a2828); color: #ffecec }
.victory-screen.sad h1 { font-size: 36px }

.standings ol { padding-left: 18px; margin: 8px 0 }
.standings li { text-align: left }
.standings strong { font-size: 15px }
.standings li span { display:inline-block }

/* Improve contrast for final standings on sad victory screen */
.victory-screen.sad .standings {
  background: rgba(255,255,255,0.02); /* subtle card behind the standings (darkened) */
  padding: 12px;
  border-radius: 10px;
  display: inline-block;
}
.victory-screen.sad .standings h4 {
  color: #fff; /* ensure heading is visible */
}
.victory-screen.sad .standings li {
  color: #fff; /* white text for list items */
}
.victory-screen.sad .standings li span {
  color: #fff;
}

/* Modal overlay for host confirmation */
.modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.65); display:flex; align-items:center; justify-content:center; z-index: 2000 }
.modal-dialog { width: 520px; max-width: 92%; padding: 18px; border-radius: 12px; color: var(--text); background: linear-gradient(180deg, rgba(26,24,26,0.98), rgba(18,16,20,0.96)); max-height: 90vh; overflow: auto }
.modal-dialog button { color: inherit; }

/* Ghost modal specific backdrop: place toward top and make sure it overlays other UI */
.modal-backdrop {
  position: fixed;
  left: 0;
  right: 0;
  top: 6vh; /* near the top of the viewport */
  display: flex;
  justify-content: center;
  align-items: flex-start;
  pointer-events: auto; /* allow interacting with modal contents */
  z-index: 13000; /* sit above other overlays (toasts, coin overlays, etc.) */
}
.modal-backdrop .modal.card {
  pointer-events: auto;
  margin: 0 auto;
  transform: none !important; /* avoid card hover transforms moving the modal */
  box-shadow: 0 12px 36px rgba(0,0,0,0.7) !important;
  max-width: 680px; /* slightly wider for readability */
}

/* Ensure the ghost modal content itself sits visually toward the top (not vertically centered) */
.modal-backdrop .modal.card > h3 { margin-top: 6px }

/* subtle entrance animation for modal dialogs: fade in and slight lift (not on hover) */
@keyframes modal-entrance {
  0% { opacity: 0; transform: translateY(8px) scale(0.995); box-shadow: 0 4px 10px rgba(0,0,0,0.6) }
  60% { opacity: 1; transform: translateY(-4px) scale(1.002); box-shadow: 0 10px 30px rgba(0,0,0,0.7) }
  100% { opacity: 1; transform: translateY(0) scale(1); box-shadow: 0 6px 18px rgba(0,0,0,0.6) }
}
.modal-dialog { animation: modal-entrance 260ms cubic-bezier(.2,.9,.2,1) both }

/* allow opting out of modal animation for specific dialogs (e.g., power-up shop) */
.modal-dialog.no-anim { animation: none !important }

/* Prevent settings modal card from moving on hover (override the generic .card:hover) */
.settings-modal .card, .settings-modal .card:hover { transform: none !important; box-shadow: 0 6px 18px rgba(0,0,0,0.6) !important }

/* Prevent the mode info popover (Game info) from 'lifting' on hover which causes
   the info box to shift and makes clicking the small buttons fiddly. Keep a
   stable box-shadow and disable transform on hover. */
.mode-info-card.card, .mode-info-card.card:hover {
  transform: none !important;
  box-shadow: 0 6px 18px rgba(0,0,0,0.6) !important;
}

/* Ensure the small settings/close buttons used inside headers don't change size
   or add outline/shift on hover: keep fixed dimensions and no transform. */
.settings-modal .card > div > button, .mode-badge .card > button {
  transition: none !important;
  transform: none !important;
}

/* Stronger safeguard: disable any transitions/transforms for all elements inside
   the settings modal and the game info popover to avoid unexpected layout shifts
   caused by global styles (e.g., .card:hover or button:hover). This is intentionally
   scoped narrowly to these overlays so other cards keep their subtle lift. */
.settings-modal, .settings-modal *,
.mode-info-card, .mode-info-card * {
  transition: none !important;
  transform: none !important;
}

/* make settings modal inputs easier to click: avoid floating transform on focus within settings modal */
.settings-modal input:focus { transform: none !important; box-shadow: 0 6px 18px rgba(100,90,80,0.06) !important }

/* Ensure controls in the settings modal (including the close button) are visible against dark background */
.settings-modal button { color: var(--text); background: transparent; border: none; font-size: 16px; cursor: pointer }
.settings-modal button:hover { color: #fff }

/* Thin black scrollbar for Settings modal: modern and webkit fallbacks */
.settings-modal .card {
  scrollbar-width: thin;
  scrollbar-color: #000 transparent;
}
.settings-modal .card::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}
.settings-modal .card::-webkit-scrollbar-track {
  background: transparent;
}
.settings-modal .card::-webkit-scrollbar-thumb {
  background: rgba(0,0,0,0.95);
  border-radius: 8px;
  border: 2px solid transparent; /* keeps thumb visually thin while preserving hit area */
  background-clip: padding-box;
}

/* Prevent modal dialogs (including the power-up shop) from floating on hover */
.modal-overlay .modal-dialog.card,
.modal-dialog.card,
.modal-overlay .modal-dialog.card:hover,
.modal-dialog.card:hover {
  transform: none !important;
  box-shadow: 0 6px 18px rgba(0,0,0,0.6) !important;
}

/* Avoid focus-induced transform for inputs inside modal dialogs (prevents modal shift when focusing fields) */
.modal-dialog input:focus,
.modal-dialog textarea:focus {
  transform: none !important;
  box-shadow: 0 6px 18px rgba(100,90,80,0.06) !important;
}

.guessed-by-list li {
  display: flex;
  flex-wrap: wrap; /* allow wrapping but keep inline alignment */
  gap: 4px; /* optional spacing between label and names */
  margin-left: 0; /* remove default UL indentation */
}

.guessed-by-list li span {
  display: inline; /* ensure spans are inline, not block */
}

/* underword header */
.underword-header { text-align: center; margin-bottom: 20px }
.underword-title {
  font-size: 44px;
  letter-spacing: -1px;
  display: inline-block;
  background: linear-gradient(90deg, var(--accent), var(--accent-2), var(--accent));
  background-size: 300%;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent; /* Safari */
  background-clip: text;
  color: transparent;
  font-weight: 800;
  /* subtle molten motion */
  animation: underword-lava 6s linear infinite;
}
.underword-title .bubble {
  display:inline-block;
  margin-left: 8px;
  transform-origin: 50% 50%;
  animation: bubble-bounce 1.6s cubic-bezier(.2,.9,.2,1) infinite;
  /* Explicit visible color so emoji renders correctly (overrides parent's transparent color) */
  color: var(--text);
  font-size: 0.95em;
  -webkit-background-clip: unset;
  background-clip: unset;
  /* subtle text shadow to help emoji stand out on gradients */
  text-shadow: 0 1px 0 rgba(0,0,0,0.6);
}
/* Ensure inline SVG in the bubble inherits color and sizes nicely */
.underword-title .bubble svg { width: 0.95em; height: 0.95em; vertical-align: -0.08em; display: inline-block }
.underword-title .bubble svg rect { /* candle body uses currentColor */ fill: currentColor }
/* flame path uses explicit fill in SVG; no extra rules needed */
.underword-tag {
  color: var(--muted);
  margin-top: 8px;
  font-size: 14px;
  opacity: 0;
  transform: translateY(6px);
  transition: opacity 520ms cubic-bezier(.2,.9,.2,1), transform 520ms cubic-bezier(.2,.9,.2,1);
  will-change: opacity, transform;
}

/* when header has loaded class, reveal the tag with a subtle raise */
.underword-header.loaded .underword-tag {
  opacity: 1;
  transform: translateY(0);
}

@keyframes bubble-bounce {
  0% { transform: translateY(0) rotate(0deg) }
  25% { transform: translateY(-6px) rotate(-6deg) }
  50% { transform: translateY(0) rotate(0deg) }
  75% { transform: translateY(-4px) rotate(6deg) }
  100% { transform: translateY(0) rotate(0deg) }
}

/* molten gradient animation for the landing title */
@keyframes underword-lava {
  0% { background-position: 0% 50%; }
 100% { background-position: 100% 50%; }
}

/* notice card */
.notice { border: 1px dashed rgba(255,255,255,0.04); background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.03)); padding: 12px; border-radius: 12px; text-align: center }
.notice h4 { margin: 0 0 6px 0 }

/* waiting pulse using CSS variable --halo */
@keyframes pulse-slow { 0% { box-shadow: 0 0 0 0 var(--halo) } 70% { box-shadow: 0 0 0 12px rgba(0,0,0,0) } 100% { box-shadow: 0 0 0 0 rgba(0,0,0,0) } }
.waiting-pulse { animation: none }
.waiting-pulse .avatar { animation: pulse-slow 1.8s infinite; }

/* glowing start button when ready (toned to sepia glow) */
.start-ready {
  box-shadow: 0 8px 30px rgba(107,79,59,0.22), 0 0 20px rgba(90,107,124,0.08) inset;
  animation: glow-pulse 1.6s ease-in-out infinite;
}

@keyframes glow-pulse {
  0% { transform: translateY(0); box-shadow: 0 8px 30px rgba(107,79,59,0.12), 0 0 6px rgba(90,107,124,0.06) inset }
  50% { transform: translateY(-3px); box-shadow: 0 18px 48px rgba(107,79,59,0.18), 0 0 18px rgba(90,107,124,0.12) inset }
  100% { transform: translateY(0); box-shadow: 0 8px 30px rgba(107,79,59,0.12), 0 0 6px rgba(90,107,124,0.06) inset }
}

/* timer bar */
.turn-timer { display:flex; align-items:center; gap:12px; margin: 12px 0 }
.turn-timer .bar { height: 10px; background: rgba(255,255,255,0.03); border-radius: 6px; flex:1; overflow:hidden }
.turn-timer .fill { height:100%; background: linear-gradient(90deg,var(--accent),var(--accent-2)); transition: width .2s linear }
.turn-timer .time { min-width:56px; text-align:right; font-weight:700; position:fixed; top: 90px; color: #ffef7e }

/* Lava-style top timer bar */
.lava-timer {
  position: fixed;
  left: 0;
  right: 0;
  top: 0;
  height: 18px;
  z-index: 13060;
  pointer-events: none;
  display: flex;
  align-items: center;
  padding: 6px 12px;
  box-sizing: border-box;
}
.lava-track {
  position: relative;
  width: 100%;
  height: 100%;
  background: #0b0b0b;
  border-radius: 6px;
  overflow: hidden;
  box-shadow: inset 0 -6px 12px rgba(0,0,0,0.6);
}
.lava-track::before {
  /* subtle cracked-rock overlay using repeating linear gradients */
  content: '';
  position: absolute;
  inset: 0;
  background-image: repeating-linear-gradient(135deg, rgba(0,0,0,0.22) 0 1px, transparent 1px 6px),
                    repeating-linear-gradient(45deg, rgba(255,255,255,0.02) 0 1px, transparent 1px 8px);
  mix-blend-mode: overlay;
  opacity: 0.9;
  pointer-events: none;
}
.lava-fill {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 0%;
  background: linear-gradient(90deg, #ff7a18 0%, #ff3b00 40%, #ff9b34 60%);
  background-size: 200% 100%;
  box-shadow: 0 0 28px rgba(255,90,0,0.45), inset 0 2px 8px rgba(255,150,80,0.08);
  transform-origin: left center;
  transition: width 0.25s linear;
  animation: lava-flow 2.6s linear infinite;
}
.lava-fill::after {
  /* molten surface sheen */
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0));
  mix-blend-mode: overlay;
  pointer-events: none;
}
.lava-ember {
  position: absolute;
  bottom: 2px;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: radial-gradient(circle, #ffd08a 0%, #ff3b00 60%);
  opacity: 0;
  pointer-events: none;
  box-shadow: 0 0 8px rgba(255,100,40,0.8);
  animation: ember-up 1.6s linear infinite;
}

@keyframes lava-flow {
  0% { background-position: 0% 50%; filter: hue-rotate(0deg); }
  50% { background-position: 50% 50%; filter: hue-rotate(6deg) brightness(1.02); }
  100% { background-position: 100% 50%; filter: hue-rotate(0deg); }
}

@keyframes ember-up {
  0% { transform: translateY(0) scale(0.6); opacity: 0; }
  10% { opacity: 1; }
  60% { transform: translateY(-18px) scale(1); opacity: 0.9; }
  100% { transform: translateY(-40px) scale(1.2); opacity: 0; }
}

/* Responsive sizing: slightly taller on larger screens */
@media (min-width: 900px) {
  .lava-timer { height: 22px; padding: 8px 18px }
  .lava-ember { width: 7px; height: 7px }
}

/* Small screens: reduce visual noise */
@media (max-width: 520px) {
  .lava-timer { height: 14px; padding: 4px 8px }
  .lava-ember { width: 5px; height: 5px }
}

/* Toasts */
.toast-container { position: fixed; right: 18px; top: 18px; z-index: 9999; display:flex; flex-direction:column; gap:8px }
.toast { background: rgba(0,0,0,0.8); color: var(--text); padding: 10px 14px; border-radius: 10px; font-weight:700; box-shadow: 0 8px 18px rgba(0,0,0,0.7); opacity: 0; transform: translateY(-6px); animation: toast-in .28s forwards }
@keyframes toast-in { to { opacity: 1; transform: translateY(0) } }

/* Success / error variants for toasts */
.toast-success { background: linear-gradient(90deg,#2e7d32,#66bb6a); color: #fff }
.toast-error { background: linear-gradient(90deg,#b71c1c,#e53935); color: #fff }

/* Double-down coin overlay */
.dd-coin-overlay { position: fixed; left: 0; right: 0; top: 0; bottom: 0; pointer-events: none; overflow: visible; z-index: 11000; /* debug: subtle outline to confirm overlay exists */ outline: 2px dashed rgba(255,255,255,0.06); background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0)); }
.dd-coin-overlay.debug-visible { outline-color: rgba(255,255,255,0.12); box-shadow: inset 0 0 24px rgba(255,255,255,0.02) }
.coin-piece { display: block; position: absolute; top: -8vh; border-radius: 50%; background: radial-gradient(circle at 30% 30%, #ffd54f, #ffb300); box-shadow: 0 6px 12px rgba(0,0,0,0.4); transform: translateY(0) scale(1); animation: coin-fall 2.6s cubic-bezier(.2,.7,0,1) forwards; will-change: transform, opacity; transform: translateZ(0); backface-visibility: hidden }
@keyframes coin-fall { 0% { transform: translateY(0) rotate(0deg); opacity: 1 } 60% { opacity: 1 } 100% { transform: translateY(110vh) rotate(360deg); opacity: 0.95 } }

/* Multi-hit toast */
.multi-hit-toast { position: relative; overflow: visible; }
.multi-hit-toast .confetti-like { position: absolute; left: -8px; top: -24px; width: 12px; height: 12px; border-radius: 2px; animation: mh-fall 900ms ease-out forwards }
.multi-hit-toast .confetti-like:nth-child(1) { left: 6px; background: #FFD54F; transform: rotate(12deg) }
.multi-hit-toast .confetti-like:nth-child(2) { left: 34px; background: #FFABAB; transform: rotate(-6deg) }
.multi-hit-toast .confetti-like:nth-child(3) { left: 60px; background: #81D4FA; transform: rotate(18deg) }

@keyframes mh-fall { from { transform: translateY(-8px) rotate(0deg); opacity: 1 } to { transform: translateY(18px) rotate(45deg); opacity: 0 } }
/* Fade-out animation for toasts when being removed */
.toast.removing { animation: toast-out .9s forwards }
@keyframes toast-out { to { opacity: 0; transform: translateY(-8px) scale(.98) } }
/* player flash for penalty */
.player.flash-penalty { animation: flash-penalty 1s ease-in-out }
@keyframes flash-penalty { 0% { box-shadow: 0 0 0 rgba(255,0,0,0) } 10% { box-shadow: 0 0 18px rgba(255,0,0,0.6) } 50% { box-shadow: 0 0 10px rgba(255,0,0,0.24) } 100% { box-shadow: 0 0 0 rgba(255,0,0,0) } }

/* wordmoney decrement pulse */
.wordmoney.decrement { animation: hang-decrement 1s ease-in-out }
@keyframes hang-decrement { 0% { transform: translateY(0); color: var(--accent-2) } 30% { transform: translateY(-6px); color: #c62828 } 100% { transform: translateY(0); color: var(--accent-2) } }

/* brief pulse when wordmoney changes */
.wordmoney.pulse span {
  transform: scale(1.08);
  box-shadow: 0 8px 18px rgba(0,0,0,0.5);
}
.wordmoney.pulse span { transition: transform 220ms cubic-bezier(.2,.9,.2,1), box-shadow 220ms cubic-bezier(.2,.9,.2,1) }

/* ensure avatar background uses provided color gracefully */
.player .avatar { color: var(--darktext); box-shadow: 0 6px 18px rgba(0,0,0,0.6); display:inline-flex; align-items:center; justify-content:center }

/* Inactive/stale player styling: greyed out appearance */
.player.player-stale { filter: grayscale(80%) contrast(.9) brightness(.9); opacity: 0.72 }
.player.player-stale .avatar { box-shadow: none; opacity: 0.8 }
.player.player-stale .revealed, .player.player-stale .wordmoney { opacity: 0.6 }

/* Eliminated / ghosted player appearance: make tiles look faded and ghostly for all viewers.
   When a player returns (player.eliminated === false), the normal styles are restored. */
.player.player-eliminated {
  opacity: 0.48;
  filter: grayscale(80%) contrast(0.9) saturate(0.6) drop-shadow(0 8px 20px rgba(0,0,0,0.6));
  transition: opacity 280ms ease, filter 280ms ease, transform 200ms ease;
}
.player.player-eliminated .avatar { opacity: 0.6; box-shadow: none }
.player.player-eliminated .revealed, .player.player-eliminated .wordmoney { opacity: 0.56 }


/* small colored dot used in waiting lists */
.waiting-dot { display:inline-block; width:10px; height:10px; border-radius:50%; margin-right:8px; vertical-align:middle; box-shadow: 0 2px 6px rgba(0,0,0,0.6) }

/* small screens */
@media (max-width:600px){.meta{ margin-left: 0; margin-top: 6px }}

/* small inline error text */
.small-error {
  color: #ff8a80; /* soft red on dark background */
  font-size: 13px;
  margin-top: 8px;
}

/* Inline guess dialog used by PlayerCircle */
.guess-dialog { display:flex; flex-direction:column; position: relative; margin-top: 8px; padding: 10px; background: linear-gradient(180deg, rgba(22,20,22,0.96), rgba(18,16,20,0.94)); border-radius: 10px; box-shadow: 0 8px 18px rgba(0,0,0,0.7); }
.guess-dialog input { width: 200px }

 /* Bottom submit bar used during the 'submit' phase and later for power-ups */
.submit-bar {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 12px;
  margin: 0 auto;
  max-width: 980px;
  display: flex;
  gap: 12px;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  border-radius: 14px;
  z-index: 999;
  background: linear-gradient(90deg, rgba(20,18,20,0.96), rgba(16,14,16,0.96));
  box-shadow: 0 10px 30px rgba(0,0,0,0.7);
}
.submit-bar .submit-left { display:flex; align-items:flex-start; gap:12px }
.submit-bar .submit-controls { display:flex; align-items:center; gap:8px }
.submit-bar input { width: 220px; background: rgba(30,28,30,0.7); color: var(--text); border: 1px solid rgba(255,255,255,0.04) }
.submit-bar .notice { background: transparent; border: none; padding: 0 }

@media (max-width:700px) {
  .submit-bar { flex-direction: column; align-items: stretch; padding: 8px 12px }
  .submit-bar .submit-controls { justify-content: flex-end }
  .submit-bar input { width: 100% }
}

/* Starter bonus badge shown during submit waiting */
.starter-badge { display:inline-block; background: linear-gradient(90deg,#3b2b1f,#2e271f); color: #e6e1dc; font-weight:700; margin-left:8px; padding: 2px 6px; border-radius: 8px; font-size: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.6) }

/* Name input required glow */
.name-input.required-glow { box-shadow: 0 0 12px rgba(201, 166, 107, 0.9); border-radius: 8px; border: 1px solid rgba(201,166,107,0.6); padding: 8px }

/* Join button glow/animation */
.join-btn.join-glow { animation: pulse 1.6s infinite; box-shadow: 0 8px 24px rgba(201,120,80,0.12); }
@keyframes pulse { 0% { transform: translateY(0) } 50% { transform: translateY(-3px) } 100% { transform: translateY(0) } }

/* Money theme: keep green background and values intact (money mode should remain green) */
.money-theme { color: #23e923 }
.money-theme .wordmoney { color: #ccfacf }
.money-anim { position: absolute; pointer-events: none }
@keyframes cash-float { 0% { transform: translateY(0) rotate(0) } 50% { transform: translateY(-16px) rotate(-8deg) } 100% { transform: translateY(0) rotate(0) } }
.cash-piece { width: 18px; height: 10px; background: linear-gradient(90deg,#a5d6a7,#66bb6a); border-radius:3px; box-shadow: 0 2px 6px rgba(0,0,0,0.2); animation: cash-float 2.2s ease-in-out infinite }

/* header mode badge */
.mode-badge { background: rgba(255,255,255,0.02); box-shadow: 0 8px 22px rgba(0,0,0,0.7); border-radius: 12px }

/* Prevent the mode badge from 'lifting' on hover like other .card elements */
.mode-badge.card, .mode-badge.card:hover {
  transform: none !important;
  box-shadow: 0 8px 22px rgba(0,0,0,0.7) !important;
}

 /* small rocket badge used to indicate power-ups are enabled in the room */
.powerup-rocket { display: inline-block; padding: 4px 6px; border-radius: 8px; background: linear-gradient(90deg,#3b2b1f,#2e271f); box-shadow: 0 6px 14px rgba(0,0,0,0.6) }

/* Power-up shop: price display should be high-contrast/dark for readability */
.powerup-price {
  color: var(--darktext);
  font-weight: 700;
  font-size: 14px;
}

/* Power-up message inline HTML helpers -------------------------------------------------- */
/* Use these classes when server-side code emits small HTML snippets (messageHtml) so
   we avoid embedding inline styles. Keep rules specific and lightweight. */
.power-name {
  color: #2b8cff; /* blue accent for power-up names */
  font-weight: 700;
}
.revealed-letter {
  color: #ffcc00; /* yellow accent for revealed letters */
  font-weight: 700;
}


/* Ensure power-up prices are dark inside modal/shop cards (override inherited light color) */
.modal-dialog.card .powerup-price,
.powerup-row .powerup-price {
  color: #1f2937; /* dark slate for reliable contrast */
}

/* adjust cash piece animation for confetti-like drop */
.victory-screen .cash-piece { width: 22px; height: 12px; border-radius: 3px; animation: cash-drop 3.0s cubic-bezier(.2,.7,0,1) forwards; will-change: transform }
@keyframes cash-drop { 0% { transform: translateY(-20px) rotate(0deg); opacity: 0 } 20% { opacity: 1 } 100% { transform: translateY(100vh) rotate(540deg); opacity: 1 } }

/* private hit chips (repeat letters for occurrences) */
.private-hit-chips { display:inline-flex; gap:6px; margin-left: 6px }
.hit-chip { background: #3b2b1f; color: #e6e1dc; padding: 4px 6px; border-radius: 6px; font-weight:700; box-shadow: 0 4px 10px rgba(0,0,0,0.6) }

/* Highlight the screen when it's the viewer's turn */
body.my-turn-body {
  transition: background 300ms ease, color 300ms ease;
  /* Use a moody amber gradient to signal your turn but keep noir vibe */
  background: linear-gradient(135deg, #24214b, #3c1a10) !important;
  color: #e6e1dc !important;
}

/* Make card-like UI elements readable on dark background */
body.my-turn-body .card,
body.my-turn-body .notice,
body.my-turn-body .toast,
body.my-turn-body .modal-dialog {
  background: linear-gradient(180deg, rgba(30,28,32,0.98), rgba(22,20,22,0.98)) !important;
  color: #e6e1dc !important;
  border-color: rgba(255,255,255,0.03) !important;
}

/* Ensure player tiles are readable */
body.my-turn-body .player {
  background: linear-gradient(180deg, rgba(28,26,28,0.98), rgba(24,22,24,0.98)) !important;
  color: #e6e1dc !important;
  box-shadow: 0 12px 30px rgba(0,0,0,0.7) !important;
}

/* Highlight the viewer's own player tile so it's easy to spot */
.player-self {
  border: 2px solid var(--accent-2);
  box-shadow: 0 12px 28px rgba(90,107,124,0.12), 0 0 26px rgba(90,107,124,0.04) inset;
  background: linear-gradient(180deg, rgba(24,22,24,0.98), rgba(29,27,29,0.98));
}
.player-self .avatar { box-shadow: 0 8px 22px rgba(90,107,124,0.12); transform: scale(1.02); }
.player-self .name { font-weight: 800 }

/* Highlight for the player whose turn it is */
.player-turn {
  border: 2px solid var(--accent);
  box-shadow: 0 14px 36px rgba(107,79,59,0.14), 0 0 26px rgba(107,79,59,0.04) inset;
  position: relative;
  animation: player-turn-pulse 1.6s ease-in-out infinite;
}
.player-turn::after {
  content: '';
  position: absolute;
  inset: -6px;
  border-radius: 18px;
  box-shadow: 0 8px 28px rgba(107,79,59,0.06);
  pointer-events: none;
}
@keyframes player-turn-pulse {
  0% { transform: translateY(0); box-shadow: 0 12px 28px rgba(107,79,59,0.06) }
  50% { transform: translateY(-4px); box-shadow: 0 20px 40px rgba(107,79,59,0.12) }
  100% { transform: translateY(0); box-shadow: 0 12px 28px rgba(107,79,59,0.06) }
}
/* Highlight the circle when it's the viewer's turn */
.circle.my-turn {
  background: rgba(139,121,86,0.06); /* subtle aged-yellow */
  transition: background-color 220ms ease, box-shadow 220ms ease;
  box-shadow: 0 8px 20px rgba(0,0,0,0.6);
  border-radius: 12px;
}
/* Shop modal: strongly isolate from body-level transitions (prevent flicker) */
.shop-modal {
  /* keep overlay color stable and avoid inheriting transitions */
  background: rgba(0,0,0,0.65) !important;
  transition: none !important;
}
.shop-modal .shop-modal-dialog,
.shop-modal-dialog {
  background: linear-gradient(180deg, rgba(30,28,32,0.98), rgba(18,16,20,0.98)) !important;
  color: var(--text) !important;
  box-shadow: 0 6px 18px rgba(0,0,0,0.7) !important;
  transform: none !important;
  transition: none !important;
}
/* also make sure the shop modal ignores the my-turn-body overrides */
body.my-turn-body .shop-modal .shop-modal-dialog,
body.my-turn-body .shop-modal {
  background: rgba(0,0,0,0.65) !important; /* overlay stays dark */
}
body.my-turn-body .player .avatar { color: var(--darktext) !important; box-shadow: 0 6px 18px rgba(0,0,0,0.6) !important }

/* Submit bar and other controls should remain prominent */
body.my-turn-body .submit-bar { box-shadow: 0 10px 30px rgba(0,0,0,0.8) !important }

/* Power-up shop header and list styling */
.shop-modal .shop-modal-dialog {
  display: flex;
  flex-direction: column;
  width: 560px;
  max-width: 94%;
  max-height: 80vh; /* contain modal to viewport */
  padding: 0; /* header and body supply padding */
  overflow: hidden;
}

.shop-modal-header {
  background: linear-gradient(90deg, var(--accent), var(--accent-2));
  color: white;
  padding: 12px 16px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  border-top-left-radius: 12px;
  border-top-right-radius: 12px;
}
.shop-modal-header small { color: rgba(255,255,255,0.9); font-weight: 400; font-size: 12px; display:block }
.shop-modal-close { background: transparent; border: none; color: white; font-size: 18px; cursor: pointer; padding: 6px 8px; border-radius: 8px }
.shop-modal-close:hover, .shop-modal-close:focus { transform: none !important; }

.powerup-list {
  padding: 12px;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  display: flex;
  flex-direction: column;
  gap: 10px;
  max-height: calc(80vh - 64px);
}

.powerup-row {
  background: linear-gradient(180deg, rgba(24,22,24,0.98), rgba(28,26,28,0.98));
  border-radius: 10px;
  padding: 10px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  box-shadow: 0 6px 14px rgba(0,0,0,0.6);
  border: 1px solid rgba(255,255,255,0.02);
}

/* Self-targeted power-ups (e.g., word_freeze, double_down, hang_shield, etc.) */
.powerup-row.self-powerup {
  background: linear-gradient(180deg, #2e241c, #291f18); /* warm noir cream feel */
  border: 1px solid rgba(255,160,0,0.04);
}

.powerup-meta { flex: 1; min-width: 0; padding-right: 12px }
  .powerup-meta .title { font-weight: 700; display: block; color: var(--darktext) }
  .powerup-meta .desc { display: block; color: #453d33; font-size: 13px; margin-top: 6px }
.powerup-actions { display: flex; align-items: center; gap: 8px }
.powerup-buy { min-width: 72px; color: var(--text); }
.powerup-buy:hover, .powerup-buy:focus { transform: none !important; }

 /* Ensure buttons inside the shop modal do not trigger card hover transforms */
.shop-modal .card:hover, .shop-modal .card { transform: none !important; box-shadow: 0 6px 18px rgba(0,0,0,0.6) !important }
.powerup-input { width: 46px; padding: 6px 8px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.04) }

/* ensure the header stands out when my-turn-body is active */
body.my-turn-body .shop-modal .shop-modal-dialog .shop-modal-header { background: linear-gradient(90deg, #6b4f3b, #5a6b7c) }

/* Keep the confetti colorful while remaining visible on dark background */
.confetti-piece { box-shadow: 0 6px 12px rgba(0,0,0,0.6); }

/* ensure cash-piece color remains green for money mode celebrations */

/* ---------------------------------------------------------------------------
   Underworld theme (enable by adding `underworld-body` to <body>)
   - subtle ember glow on card edges
   - drifting, low-opacity smoke layers for depth
   - faint runic-symbol pattern across the background (very low opacity)
   Keep everything low-opacity and GPU-friendly (blur + translate animations).
-----------------------------------------------------------------------------*/

body.underworld-body {
  /* slightly warm tint to the overall background while preserving contrast */
  background: linear-gradient(180deg, #0b0b0b, #0f0c0c 80%);
}

/* Ember edge: faint, warm inset glow on cards to suggest embers beneath the surface */
body.underworld-body .card {
  /* preserve existing shadows but add a subtle warm inset glow */
  box-shadow: 0 6px 18px rgba(0,0,0,0.6), inset 0 0 36px rgba(255,110,60,0.03);
  border: 1px solid rgba(255,110,60,0.02);
  position: relative; /* ensure pseudo layers align */
  overflow: visible;
}

/* A soft ember vignette sits at the edges using a pseudo-element to avoid changing markup */
body.underworld-body .card::before {
  content: '';
  position: absolute;
  inset: -2px; /* slightly larger than card to catch edges */
  pointer-events: none;
  background: radial-gradient(120% 80% at 10% 10%, rgba(255,140,60,0.035), transparent 12%),
              radial-gradient(120% 80% at 90% 90%, rgba(255,80,30,0.02), transparent 12%);
  mix-blend-mode: screen;
  z-index: 0;
  border-radius: inherit;
}

/* Put card contents above the ember layer */
body.underworld-body .card > * { position: relative; z-index: 1 }

/* Drifting smoke decoration placed above background but under UI cards */
body.underworld-body .underworld-smoke {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 20; /* under most UI (cards and modals are z-index > 100) */
  overflow: hidden;
}

/* two layered smoke passes for parallax feel */
body.underworld-body .underworld-smoke::before,
body.underworld-body .underworld-smoke::after {
  content: '';
  position: absolute;
  left: -10%;
  right: -10%;
  bottom: -20%;
  height: 60%;
  background: radial-gradient(closest-side, rgba(20,18,20,0.6), rgba(20,18,20,0.32) 30%, rgba(20,18,20,0) 70%);
  filter: blur(40px);
  opacity: 0.12;
  transform: translateY(0) scale(1.02);
  will-change: transform, opacity;
}
body.underworld-body .underworld-smoke::after { bottom: -40%; opacity: 0.08; filter: blur(56px); }

@keyframes smoke-drift-slow {
  0% { transform: translateY(0) scale(1); opacity: 0.08 }
  50% { transform: translateY(-6%) scale(1.02); opacity: 0.12 }
  100% { transform: translateY(-12%) scale(1.04); opacity: 0.06 }
}
@keyframes smoke-drift-fast {
  0% { transform: translateY(0) scale(1); opacity: 0.06 }
  50% { transform: translateY(-10%) scale(1.03); opacity: 0.10 }
  100% { transform: translateY(-22%) scale(1.06); opacity: 0.04 }
}
body.underworld-body .underworld-smoke::before { animation: smoke-drift-slow 16s linear infinite }
body.underworld-body .underworld-smoke::after { animation: smoke-drift-fast 26s linear infinite }

/* Ember flicker: subtle moving warm highlights across the page (GPU friendly) */
body.underworld-body .ember-flicker {
  position: fixed; inset: 0; pointer-events: none; z-index: 22;
  background-image: radial-gradient(circle at 20% 10%, rgba(255,140,60,0.02), transparent 6%),
                    radial-gradient(circle at 80% 90%, rgba(255,90,30,0.02), transparent 6%);
  mix-blend-mode: screen; opacity: 0.9; will-change: opacity, transform;
  animation: ember-flicker 6s ease-in-out infinite;
}
@keyframes ember-flicker { 0% { opacity: 0.9 } 50% { opacity: 1 } 100% { opacity: 0.9 } }

/* Faint runic-symbol pattern across the viewport. Very low opacity so it's decorative only. */
body.underworld-body::before {
  content: '';
  position: fixed; inset: 0; pointer-events: none; z-index: 5;
  background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='240' height='240' viewBox='0 0 240 240'><text x='8' y='32' font-family='serif' font-size='22' fill='rgba(255,255,255,0.12)'>ᚠᚢᚦᚨᚱᚲ</text><text x='8' y='96' font-family='serif' font-size='22' fill='rgba(255,255,255,0.12)'>ᚷᚹᚺᚻᚾᛁ</text><text x='8' y='160' font-family='serif' font-size='22' fill='rgba(255,255,255,0.12)'>ᛃᛇᛈᛉᛋᛏ</text></svg>");
  opacity: 0.04; background-repeat: repeat; background-position: center; mix-blend-mode: overlay;
}

/* Reduce decoration on small screens to avoid visual noise */
@media (max-width: 520px) {
  body.underworld-body .underworld-smoke::before,
  body.underworld-body .underworld-smoke::after,
  body.underworld-body .ember-flicker { display: none }
  body.underworld-body::before { opacity: 0.02 }
}

/* Keep these decorations very light so they never obscure UI or reduce accessibility. */

/* Ambient floating embers specific to the lobby screen (very faint, decorative) */
.lobby { position: relative; z-index: 1 }
.lobby .ambient-embers {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0; /* sit behind the lobby UI which is z-index:1 */
  overflow: hidden;
}
.lobby .card { position: relative; z-index: 2 }
.lobby .ambient-embers .ember {
  position: absolute;
  bottom: -6%;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: radial-gradient(circle at 30% 30%, rgba(255,240,180,0.98) 0%, rgba(255,145,50,0.98) 55%, rgba(255,90,30,0.95) 100%);
  box-shadow: 0 0 18px rgba(255,140,40,0.36);
  opacity: 0.24; /* increased base opacity for better visibility */
  transform: translateY(0) scale(0.95);
  will-change: transform, opacity;
  animation-name: ember-float;
  animation-timing-function: ease-in-out;
  animation-iteration-count: infinite;
}
.lobby .ambient-embers .ember:nth-child(1) { left: 6%; animation-duration: 9s; animation-delay: 0s; width:6px; height:6px; opacity:0.18 }
.lobby .ambient-embers .ember:nth-child(2) { left: 22%; animation-duration: 12s; animation-delay: 1.2s; width:8px; height:8px; opacity:0.22 }
.lobby .ambient-embers .ember:nth-child(3) { left: 38%; animation-duration: 11s; animation-delay: 0.8s; width:9px; height:9px; opacity:0.20 }
.lobby .ambient-embers .ember:nth-child(4) { left: 54%; animation-duration: 10s; animation-delay: 0.6s; width:6px; height:6px; opacity:0.19 }
.lobby .ambient-embers .ember:nth-child(5) { left: 68%; animation-duration: 15s; animation-delay: 2.2s; width:8px; height:8px; opacity:0.18 }
.lobby .ambient-embers .ember:nth-child(6) { left: 80%; animation-duration: 13s; animation-delay: 1s; width:6px; height:6px; opacity:0.20 }
.lobby .ambient-embers .ember:nth-child(7) { left: 88%; animation-duration: 17s; animation-delay: 3.2s; width:8px; height:8px; opacity:0.18 }
.lobby .ambient-embers .ember:nth-child(8) { left: 46%; animation-duration: 8s; animation-delay: 0.4s; width:5px; height:5px; opacity:0.17 }
.lobby .ambient-embers .ember:nth-child(9)  { left: 10%; animation-duration: 13s; animation-delay: 0.8s; width:7px; height:7px; opacity:0.20 }
.lobby .ambient-embers .ember:nth-child(10) { left: 16%; animation-duration: 15s; animation-delay: 2.1s; width:8px; height:8px; opacity:0.22 }
.lobby .ambient-embers .ember:nth-child(11) { left: 28%; animation-duration: 10s; animation-delay: 0.5s; width:6px; height:6px; opacity:0.21 }
.lobby .ambient-embers .ember:nth-child(12) { left: 34%; animation-duration: 12s; animation-delay: 1.6s; width:8px; height:8px; opacity:0.24 }
.lobby .ambient-embers .ember:nth-child(13) { left: 42%; animation-duration: 14s; animation-delay: 0.2s; width:9px; height:9px; opacity:0.20 }
.lobby .ambient-embers .ember:nth-child(14) { left: 58%; animation-duration: 11s; animation-delay: 0.9s; width:7px; height:7px; opacity:0.22 }
.lobby .ambient-embers .ember:nth-child(15) { left: 62%; animation-duration: 16s; animation-delay: 2.6s; width:8px; height:8px; opacity:0.19 }
.lobby .ambient-embers .ember:nth-child(16) { left: 72%; animation-duration: 10s; animation-delay: 1.1s; width:6px; height:6px; opacity:0.21 }
.lobby .ambient-embers .ember:nth-child(17) { left: 76%; animation-duration: 14s; animation-delay: 3.4s; width:9px; height:9px; opacity:0.23 }
.lobby .ambient-embers .ember:nth-child(18) { left: 84%; animation-duration: 12s; animation-delay: 1.9s; width:7px; height:7px; opacity:0.20 }
.lobby .ambient-embers .ember:nth-child(19) { left: 92%; animation-duration: 18s; animation-delay: 4.2s; width:8px; height:8px; opacity:0.18 }
.lobby .ambient-embers .ember:nth-child(20) { left: 50%; animation-duration: 9s; animation-delay: 0.6s;  width:6px; height:6px; opacity:0.21 }
/* extra embers for increased density */
.lobby .ambient-embers .ember:nth-child(21) { left: 4%; animation-duration: 14s; animation-delay: 1.1s; width:6px; height:6px; opacity:0.16 }
.lobby .ambient-embers .ember:nth-child(22) { left: 12%; animation-duration: 13s; animation-delay: 0.9s; width:7px; height:7px; opacity:0.18 }
.lobby .ambient-embers .ember:nth-child(23) { left: 24%; animation-duration: 10s; animation-delay: 2.4s; width:8px; height:8px; opacity:0.20 }
.lobby .ambient-embers .ember:nth-child(24) { left: 36%; animation-duration: 12s; animation-delay: 1.7s; width:6px; height:6px; opacity:0.22 }
.lobby .ambient-embers .ember:nth-child(25) { left: 48%; animation-duration: 11s; animation-delay: 0.5s; width:9px; height:9px; opacity:0.24 }
.lobby .ambient-embers .ember:nth-child(26) { left: 60%; animation-duration: 16s; animation-delay: 2.8s; width:7px; height:7px; opacity:0.20 }
.lobby .ambient-embers .ember:nth-child(27) { left: 70%; animation-duration: 9s; animation-delay: 0.3s; width:6px; height:6px; opacity:0.18 }
.lobby .ambient-embers .ember:nth-child(28) { left: 82%; animation-duration: 15s; animation-delay: 3.0s; width:8px; height:8px; opacity:0.22 }
.lobby .ambient-embers .ember:nth-child(29) { left: 90%; animation-duration: 12s; animation-delay: 1.2s; width:7px; height:7px; opacity:0.19 }
.lobby .ambient-embers .ember:nth-child(30) { left: 56%; animation-duration: 13s; animation-delay: 0.7s; width:6px; height:6px; opacity:0.17 }

@keyframes ember-float {
  0% { transform: translateY(0) translateX(0) scale(0.95); opacity: 0.22 }
  20% { opacity: 0.36; transform: translateY(-8vh) translateX(1vw) scale(1) }
  55% { transform: translateY(-34vh) translateX(3vw) scale(1.06); opacity: 0.22 }
  100% { transform: translateY(-72vh) translateX(-2vw) scale(1.18); opacity: 0 }
}

@media (max-width: 520px) {
  .lobby .ambient-embers .ember { opacity: 0.16; transform: scale(0.85); box-shadow: 0 0 12px rgba(255,120,40,0.28) }
}

/* Faint side-originating smoke for the Lobby phase (very subtle, non-interactive) */
.lobby-smoke {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 1; /* just behind cards */
  overflow: hidden;
}
.lobby-smoke .smoke {
  position: absolute;
  bottom: -12%;
  width: 40%;
  height: 70%;
  border-radius: 50%;
  /* warmer, slightly stronger smoke to read over darker backgrounds */
  background: radial-gradient(closest-side, rgba(255,200,120,0.16), rgba(255,120,40,0.06));
  filter: blur(36px);
  opacity: 0.12; /* more visible but still decorative */
  transform: translateY(0) scale(1);
  will-change: transform, opacity;
  mix-blend-mode: screen;
}
.lobby-smoke .smoke-left { left: -8%; animation: smoke-side-left 22s linear infinite }
.lobby-smoke .smoke-right { right: -8%; animation: smoke-side-right 24s linear infinite }

@keyframes smoke-side-left {
  0% { transform: translateY(0) translateX(0) scale(1); opacity: 0.10 }
  20% { transform: translateY(-8vh) translateX(2vw) scale(1.01); opacity: 0.16 }
  50% { transform: translateY(-28vh) translateX(3vw) scale(1.04); opacity: 0.14 }
  85% { transform: translateY(-44vh) translateX(1.5vw) scale(1.06); opacity: 0.09 }
  100% { transform: translateY(-60vh) translateX(0vw) scale(1.08); opacity: 0 }
}

@keyframes smoke-side-right {
  0% { transform: translateY(0) translateX(0) scale(1); opacity: 0.10 }
  20% { transform: translateY(-10vh) translateX(-2vw) scale(1.01); opacity: 0.16 }
  50% { transform: translateY(-30vh) translateX(-3vw) scale(1.03); opacity: 0.13 }
  85% { transform: translateY(-52vh) translateX(-1.5vw) scale(1.05); opacity: 0.08 }
  100% { transform: translateY(-68vh) translateX(0vw) scale(1.06); opacity: 0 }
}

@media (max-width: 520px) {
  .lobby-smoke .smoke { opacity: 0.09; filter: blur(28px) }
}

/* Floating souls / wisps for the Lobby phase (scoped to .lobby .ambient-embers) */
.lobby .ambient-embers::before,
.lobby .ambient-embers::after {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  background-repeat: no-repeat;
  /* layered soft radial gradients to simulate drifting souls/wisps */
  background-image:
    radial-gradient(circle at 18% 30%, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.00) 20%),
    radial-gradient(circle at 75% 70%, rgba(255,255,255,0.06) 0%, rgba(255,255,255,0.00) 16%),
    radial-gradient(circle at 50% 50%, rgba(255,240,220,0.03) 0%, rgba(255,240,220,0) 30%);
  opacity: 0.9;
  mix-blend-mode: screen;
  animation: souls-drift 16s linear infinite;
  transform: translateY(0);
}
.lobby .ambient-embers::after {
  opacity: 0.6;
  filter: blur(18px);
  animation-duration: 22s;
  animation-delay: 4s;
}

@keyframes souls-drift {
  0% { transform: translateY(0) translateX(0) scale(1); opacity: 0 }
  10% { opacity: 0.25 }
  50% { transform: translateY(-18vh) translateX(4vw) scale(1.06); opacity: 0.55 }
  90% { opacity: 0.18 }
  100% { transform: translateY(-38vh) translateX(-2vw) scale(1.12); opacity: 0 }
}
